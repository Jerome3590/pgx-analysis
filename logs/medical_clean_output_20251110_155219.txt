üîß Using Version 1997 - APCD Clean Orchestrator
2025-11-10 15:52:20,848 - INFO - Args: {'job': 'medical', 'raw_pharmacy': 's3://pgxdatalake/silver/pharmacy/*.parquet', 'raw_medical': 's3://pgxdatalake/silver/medical/*.parquet', 'pharmacy_input': None, 'medical_input': None, 'output_root': 's3://pgxdatalake/gold/medical', 'tmp_dir': None, 'min_year': 2016, 'max_year': 2020, 'min_rows': 1, 'limit': None, 'pairs': None, 'pairs_file': None, 'workers': 9, 'retries': 1, 'lookahead_years': 5, 'dry_run': False, 'run_mode': 'subprocess', 'pharmacy_module': 'pharmacy_clean', 'medical_module': 'medical_clean', 'pharmacy_script': '', 'medical_script': '/home/pgx3874/pgx-analysis/1_apcd_input_data/3b_clean_medical.py', 'demographics_lookup': None, 'python_bin': '/home/pgx3874/jupyter-env/bin/python3.11', 'log_level': 'INFO'}
2025-11-10 15:52:20,848 - INFO - Using subprocess mode: /home/pgx3874/jupyter-env/bin/python3.11 /home/pgx3874/pgx-analysis/1_apcd_input_data/3b_clean_medical.py
2025-11-10 15:52:20,848 - INFO - Discovery (medical) starting...
2025-11-10 15:52:20,848 - INFO - üîç Looking for partitions in: s3://pgxdatalake/silver/imputed/medical_partitioned
2025-11-10 15:52:20,848 - INFO - üîç S3 bucket: pgxdatalake, prefix: silver/imputed/medical_partitioned
2025-11-10 15:52:20,912 - INFO - üîç Found 45 total objects, extracted 45 partition pairs
2025-11-10 15:52:20,913 - INFO - Discovery (medical) returned 45 partitions in 0.06s
2025-11-10 15:52:20,913 - INFO - Discovery total time: 0.07s
2025-11-10 15:52:20,914 - INFO - ‚Üí Validating input dataset paths...
2025-11-10 15:52:20,958 - WARNING - Pharmacy input path may not exist or contain parquet files: s3://pgxdatalake/silver/pharmacy/*.parquet
2025-11-10 15:52:20,972 - WARNING - Medical input path may not exist or contain parquet files: s3://pgxdatalake/silver/medical/*.parquet
2025-11-10 15:52:20,972 - WARNING - ‚ö† No input dataset paths could be validated
2025-11-10 15:52:20,972 - ERROR - ‚ùå Neither pharmacy nor medical input paths validated. Aborting to surface errors early.
2025-11-10 15:52:21,034 - INFO - ‚úì Saved text file to s3://pgx-repository/build_logs/apcd_input_data/orchestrator/medical/20251110-155220/log_20251110_155220.txt
2025-11-10 15:52:21,034 - INFO - ‚úì Logs saved to S3: s3://pgx-repository/build_logs/apcd_input_data/orchestrator/medical/20251110-155220/log_20251110_155220.txt
